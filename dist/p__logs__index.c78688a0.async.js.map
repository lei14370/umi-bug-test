{"version":3,"file":"p__logs__index.c78688a0.async.js","mappings":"yHACA,MAAe,CAAC,KAAO,eAAe,MAAQ,gBAAgB,QAAU,iBAAiB,E,iCCOnFA,EAAO,SAACC,EAAoC,CAChD,IAAQC,EAAkCD,EAAlCC,MAAOC,EAA2BF,EAA3BE,SAAQ,EAAmBF,EAAjBG,KAAAA,EAAO,IAAH,OAAG,GAAK,EACrC,SACE,eAAK,UAAWC,EAAAA,KAAY,aAC1B,eAAK,UAAWA,EAAAA,MAAa,UAC1BD,KACC,OAAC,IAAM,CAAC,MAAO,CAAEE,YAAa,EAAG,EAAG,QAAS,kBAAMC,EAAAA,QAAAA,KAAa,CAAC,EAAC,SAAC,cAEnE,GACE,KACHL,CAAK,EAAC,KAET,cAAK,UAAWG,EAAAA,QAAe,SAAEF,CAAQ,CAAC,CAAM,GAGtD,EACA,EAAeH,C,sICbTQ,EAAgB,UAAM,CAC1B,IAAMC,KAAYC,EAAAA,QAAM,EAElBC,KAAUC,EAAAA,SACd,iBAAM,CACJ,CACEC,UAAW,aACXX,MAAO,2BACPY,aAAc,EAChB,EACA,CACED,UAAW,aACXX,MAAO,2BACPa,UAAW,YACXC,YAAa,EAMf,EACA,CACEH,UAAW,QACXX,MAAO,mBACT,EACA,CACEW,UAAW,UACXX,MAAO,SACT,EACA,CACEW,UAAW,OACXX,MAAO,2BACPa,UAAW,SACXE,UAAW,CACT,EAAG,2BACH,EAAG,0BACL,CACF,EACA,CACEJ,UAAW,SACXX,MAAO,cACT,EACA,CACEW,UAAW,KACXX,MAAO,KACPY,aAAc,EAChB,EACA,CACED,UAAW,SACXX,MAAO,iBACPY,aAAc,EAChB,EACA,CACED,UAAW,kBACXX,MAAO,gBACT,EACA,CACEW,UAAW,YACXX,MAAO,0BACT,EACA,CACEW,UAAW,MACXX,MAAO,KACT,EACA,CACEW,UAAW,YACXX,MAAO,gCACT,EACA,CACEA,MAAO,eACPgB,IAAK,eACLC,WAAY,GACZL,aAAc,GACdM,OAAQ,SAACC,EAAa,CACpB,MAAO,IACL,OAAC,KAAU,CACT,KAAK,OAEL,QAAS,UAAM,CACbd,EAAAA,QAAAA,KAAa,mBAAqBc,EAAIC,EAAE,CAC1C,EAAE,SACH,cAED,EANM,GAAG,CAMI,CAEjB,CACF,CAAC,CACF,EACD,CAAC,CAAC,EAGJ,SACE,OAAC,IAAI,CAAC,MAAM,2BAAM,YAChB,OAAC,IAAQ,CACP,QAASX,EACT,UAAWF,EACX,OAAO,KACP,YAAa,IACX,OAAC,KAAU,CACT,KAAK,UAEL,QAAM,OAAC,IAAY,IACnB,QAAS,UAAM,CACbF,EAAAA,QAAAA,KAAa,cAAc,CAC7B,EAAE,SACH,cAED,EAPM,GAAG,CAOI,EAEf,WAASgB,EAAAA,IAAiBC,EAAAA,CAAQ,CAAE,EACpC,EAGR,EAEA,UAAehB,C,0JCzHR,SAAegB,EAAS,EAAD,gCAQ9B,qCARO,WAAwBC,EAAa,CAAF,8FACjCC,EAAAA,IAA6B,iCAAkC,CACpEC,OAAQ,MACRF,OAAQ,OACHA,CAAM,CAEb,CAAC,CAAC,wCACH,2BAEM,SAAeG,EAAmB,EAAD,gCAUvC,qCAVM,WAAkCH,EAAa,CAAF,8FAC3CC,EAAAA,IACL,+CACA,CACEC,OAAQ,MACRF,OAAQ,OACHA,CAAM,CAEb,CAAC,CACF,wCACF,2B,iKCPYI,EAAyB,SAACC,EAAUC,EAAkB,CACjE,IAAIC,EAAYF,EAChB,SAAIG,EAAAA,OAAMH,CAAG,EACJ,IAELE,IAAS,oBAAoBE,KAAKF,CAAI,GAAKA,aAAgBG,EAAAA,KAC7DH,EACED,EAAQ,EACJI,EAAAA,EAAOH,CAAI,EAAEI,OAAO,qBAAqB,EACzCD,EAAAA,EAAOH,CAAI,EAAEI,OAAO,qBAAqB,GAE1CJ,EACT,EACaK,EAAuB,SAACC,EAA+B,CAClE,IAAMC,EAA4B,OAAKD,CAAK,EAC5C,QAAWpB,KAAOqB,EACZA,EAAKC,eAAetB,CAAG,GAAKqB,EAAKrB,CAAG,IAAM,GAC5C,OAAOqB,EAAKrB,CAAG,EACNqB,EAAKrB,CAAG,YAAauB,OAC1BF,EAAKrB,CAAG,EAAEwB,OAAS,IACrBH,EAAKrB,CAAG,EAAKqB,EAAKrB,CAAG,EAClByB,IAAI,SAACC,EAAGb,EAAU,CACjB,OAAOF,EAAuBe,EAAGb,CAAK,CACxC,CAAC,EACAc,KAAK,GAAG,GAIjB,OAAON,CACT,EACO,SAASO,EAAYC,EAAwB,CAClD,GAAIC,QAAQD,EAAME,SAAS,CAAC,EAC1B,MAAO,GAET,IAAMC,EAAM,qBACZ,OAAOH,EAAME,SAAS,EAAEE,QAAQD,EAAK,GAAG,CAC1C,CACO,SAAS3B,EACd6B,EAIAC,EACA,CACA,uCAAO,WACLC,EAGuB,iFAEjBf,OAAAA,EAAO,OAAKe,CAAK,EACjBC,EAAUhB,EAAKiB,QACrB,OAAOjB,EAAKiB,QACNC,EAAQpB,EAAqBE,CAAI,EAAC,SAGtBa,EAAgB,WAC7BC,CAAa,MAChBK,KAAMH,EACNI,KAAMpB,EAAKqB,QAAQ,EAChBH,CAAK,GACR,OALII,OAAAA,EAAM,EAAH,KAMTC,QAAQC,IAAIF,CAAG,EAAE,kBACV,CACLtB,KAAMsB,GAAG,YAAHA,EAAKG,KACXC,MAAOJ,GAAG,SAAHA,EAAKK,cAAU,iBAAZ,OAAH,EAAiBD,KAC1B,CAAC,wCACF,wDACH,C","sources":["webpack:///./src/components/Page/index.less?59b4","webpack:///./src/components/Page/index.tsx","webpack:///./src/pages/logs/index.tsx","webpack:///./src/services/logs.ts","webpack:///./src/utils/common.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"page\":\"page___H3pMP\",\"title\":\"title___j7m6E\",\"content\":\"content___fl5JM\"};","import styles from './index.less';\nimport { PropsWithChildren } from 'react';\nimport { Button } from 'antd';\nimport { history } from 'umi';\ntype Props = {\n  title: string;\n  back?: boolean;\n};\nconst Home = (props: PropsWithChildren<Props>) => {\n  const { title, children, back = false } = props;\n  return (\n    <div className={styles.page}>\n      <div className={styles.title}>\n        {back ? (\n          <Button style={{ marginRight: 10 }} onClick={() => history.back()}>\n            返回\n          </Button>\n        ) : null}\n        {title}\n      </div>\n      <div className={styles.content}>{children}</div>\n    </div>\n  );\n};\nexport default Home;\n","import type { ActionType, ProColumns } from '@ant-design/pro-components';\n\nimport { useMemo, useRef } from 'react';\nimport { AuthButton } from 'md-web-ui';\nimport { history } from 'umi';\n\nimport Page from '@/components/Page';\nimport { tableListRequest } from '@/utils/common';\nimport { ProTable } from '@ant-design/pro-components';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { findPage } from '@/services/logs';\nconst PageComponent = () => {\n  const actionRef = useRef<ActionType>();\n\n  const columns = useMemo<ProColumns[]>(\n    () => [\n      {\n        dataIndex: 'createTime',\n        title: '创建时间',\n        hideInSearch: true,\n      },\n      {\n        dataIndex: 'createTime',\n        title: '创建时间',\n        valueType: 'dateRange',\n        hideInTable: true,\n        // search:{\n        //   transform:(val)=>{\n        //     return val.json(',')\n        //   }\n        // }\n      },\n      {\n        dataIndex: 'appId',\n        title: '应用appId',\n      },\n      {\n        dataIndex: 'version',\n        title: 'version',\n      },\n      {\n        dataIndex: 'type',\n        title: '日志类型',\n        valueType: 'select',\n        valueEnum: {\n          0: '错误日志',\n          1: '行为日志',\n        },\n      },\n      {\n        dataIndex: 'action',\n        title: '行为',\n      },\n      {\n        dataIndex: 'ip',\n        title: 'ip',\n        hideInSearch: true,\n      },\n      {\n        dataIndex: 'ipAddr',\n        title: 'ip地址',\n        hideInSearch: true,\n      },\n      {\n        dataIndex: 'thirdCustomerId',\n        title: '用户Id',\n      },\n      {\n        dataIndex: 'cellPhone',\n        title: '用户电话',\n      },\n      {\n        dataIndex: 'url',\n        title: 'url',\n      },\n      {\n        dataIndex: 'userAgent',\n        title: '游览器信息',\n      },\n      {\n        title: '操作',\n        key: '操作',\n        hideInForm: true,\n        hideInSearch: true,\n        render: (row: any) => {\n          return [\n            <AuthButton\n              type=\"link\"\n              key=\"3\"\n              onClick={() => {\n                history.push('/logs/detail?id=' + row.id);\n              }}\n            >\n              详情\n            </AuthButton>,\n          ];\n        },\n      },\n    ],\n    [],\n  );\n\n  return (\n    <Page title=\"用户管理\">\n      <ProTable\n        columns={columns}\n        actionRef={actionRef}\n        rowKey=\"id\"\n        headerTitle={[\n          <AuthButton\n            type=\"primary\"\n            key=\"1\"\n            icon={<PlusOutlined />}\n            onClick={() => {\n              history.push('/user/detail');\n            }}\n          >\n            新增\n          </AuthButton>,\n        ]}\n        request={tableListRequest(findPage)}\n      />\n    </Page>\n  );\n};\n\nexport default PageComponent;\n","// @ts-ignore\n/* eslint-disable */\nimport request from '@/utils/request';\n\n/** 分页 GET */\nexport async function findPage(params: any) {\n  return request<API.API_RESULT<any>>('/monitor/application/logs/page', {\n    method: 'GET',\n    params: {\n      ...params,\n    },\n  });\n}\n/**  详情 GET */\nexport async function findSourcesContent(params: any) {\n  return request<API.API_RESULT<any>>(\n    '/monitor/application/logs/findSourcesContent',\n    {\n      method: 'GET',\n      params: {\n        ...params,\n      },\n    },\n  );\n}\n","import { isEmpty, isNil } from 'lodash';\nimport moment from 'moment';\ntype CommonSearchParams<T> = {\n  size: number | undefined;\n  page: number | undefined;\n} & T;\n\ntype CommonList<T = Record<string, any>> = {\n  /** 数据 */\n  list: T[];\n  /** 总量 */\n  pagination: {\n    page: number;\n    size: number;\n    total: number;\n  };\n};\nexport const dateTypeParamFormatter = (day: any, index: number) => {\n  let $day: any = day;\n  if (isNil(day)) {\n    return '';\n  }\n  if ($day && (/\\d{4}-\\d{2}-\\d{2}/.test($day) || $day instanceof moment)) {\n    $day =\n      index > 0\n        ? moment($day).format('YYYY-MM-DD 23:59:59')\n        : moment($day).format('YYYY-MM-DD 00:00:00');\n  }\n  return $day;\n};\nexport const searchQueryFormatter = (query: Record<string, any>) => {\n  const data: Record<string, any> = { ...query };\n  for (const key in data) {\n    if (data.hasOwnProperty(key) && data[key] === '') {\n      delete data[key];\n    } else if (data[key] instanceof Array) {\n      if (data[key].length > 0) {\n        data[key] = (data[key] as any[])\n          .map((i, index) => {\n            return dateTypeParamFormatter(i, index);\n          })\n          .join(',');\n      }\n    }\n  }\n  return data;\n};\nexport function formatMoney(money: number | string) {\n  if (isEmpty(money.toString())) {\n    return '';\n  }\n  const reg = /(?=(\\B)(\\d{3})+$)/g;\n  return money.toString().replace(reg, ',');\n}\nexport function tableListRequest<T = any, P = any>(\n  convertFunction: (\n    data: CommonSearchParams<P>,\n    options?: Record<string, any>,\n  ) => Promise<CommonList<T> | undefined>,\n  defaultParams?: Record<string, any>,\n) {\n  return async (\n    _data: P & {\n      pageSize?: number;\n      current?: number;\n    } & Record<string, any>,\n  ) => {\n    const data = { ..._data };\n    const pageNum = data.current;\n    delete data.current;\n    const $data = searchQueryFormatter(data) as P & {\n      pageSize?: number;\n    } & Record<string, any>;\n    const res = await convertFunction({\n      ...defaultParams,\n      page: pageNum,\n      size: data.pageSize,\n      ...$data,\n    });\n    console.log(res);\n    return {\n      data: res?.list,\n      total: res?.pagination?.total,\n    };\n  };\n}\n"],"names":["Home","props","title","children","back","styles","marginRight","history","PageComponent","actionRef","useRef","columns","useMemo","dataIndex","hideInSearch","valueType","hideInTable","valueEnum","key","hideInForm","render","row","id","tableListRequest","findPage","params","request","method","findSourcesContent","dateTypeParamFormatter","day","index","$day","isNil","test","moment","format","searchQueryFormatter","query","data","hasOwnProperty","Array","length","map","i","join","formatMoney","money","isEmpty","toString","reg","replace","convertFunction","defaultParams","_data","pageNum","current","$data","page","size","pageSize","res","console","log","list","total","pagination"],"sourceRoot":""}